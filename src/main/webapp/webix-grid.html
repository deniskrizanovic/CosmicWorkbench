<!DOCTYPE html>
<html lang="en">
<head>
    <title>Cosmic Workbench</title>
    <script src="handlebars.min-latest.js" type="text/javascript" charset="utf-8"></script>

    <link rel="stylesheet" href="resources/js/codebase/skins/terrace.css" type="text/css" charset="utf-8">
    <script src="resources/js/codebase/webix.js" type="text/javascript" charset="utf-8"></script>


    <script src="systemContext.js" type="text/javascript" charset="utf-8"></script>
    <script src="dataGroups.js" type="text/javascript" charset="utf-8"></script>
    <script src="sizingScenarios.js" type="text/javascript" charset="utf-8"></script>
    <script src="functionalProcesses.js" type="text/javascript" charset="utf-8"></script>


</head>

<style>
    /* this is here because the header don't wrap properly. It's not a real solution either. */
    .webix_hcell{
        white-space:nowrap;
    }
</style>

<body>

<div id="webixUItable" style='width:1500px; height:600px; margin:20px'></div>

<script>


    //not sure what this does.
    var addFunctionalProcessButton = {
        view: "button",
        id: "addFunctionalProcessButton",
        value: "Add Functional Process",
        autowidth: true,
        click: function (id, context) {
            $$("AddFPWindow").show();
        }
    };


    var FPformHeader = {

        cols: [
            {template: "Choose a new Process"},
            {view: "button", type: "icon", icon: "close", align: "right", click: ("$$('AddFPForm').hide();")}

        ]
    };


    var addFunctionalProcessWindow = {
        view: "window",
        id: "AddFPWindow",
        position: "Centre",
        modal: true,
        head: FPformHeader,
        body: selectDataGroupForm,
        on: {
            onBeforeShow: function () {
                $$("selectDG").show();
            }
        }
    };


    var mainToolbar = {
        view: "toolbar",
        width: 40,
        rows: [
            {
                view: "button",
                type: "icon",
                icon: "connectdevelop",
                tooltip: "System Context",
                click: ("navigateTo('systemContext');")
            },
            {
                view: "button",
                type: "icon",
                icon: "code-fork",
                tooltip: "Functional Processes",
                click: ("navigateTo('movements');")
            },
            {
                view: "button",
                type: "icon",
                icon: "database",
                tooltip: "Data Groups",
                click: ("navigateTo('dataGroups');")
            },
            {
                view: "button",
                type: "icon",
                icon: "exchange",
                tooltip: "Data Movements",
                click: ("navigateTo('movements');")
            },
            {
                view: "button",
                type: "icon",
                icon: "photo",
                tooltip: "Sizing Scenarios",
                click: ("navigateTo('sizingScenarios');")
            }
        ]
    };

    var toolbar = {
        view: "toolbar",
        id: "myToolbar",
        paddingY: 2,
        rows: [
            mainToolbar]
    };


    var openingScreenBody = {

        view: "template",
        template: "Welcome to the Cosmic WorkBench"
    }


</script>
<script>


    function navigateTo(location) {

        if (location == "systemContext") {
            systemContextList.data = getListofSystemContexts();
            webix.ui([systemContextsWindows], $$("theWholeThing"));
        }
        if (location == "movements") {
            fpList.data = getListOfFunctionalProcesses();
            webix.ui([movementsWindow], $$("theWholeThing"));
            $$("ctxMenu").attachTo($$("fpGrid"));
        }

        if (location == "dataGroups") {
            dataGroupList.data = getListofDataGroups();
            webix.ui([dataGroupWindow], $$("theWholeThing"));
        }

        if (location == "sizingScenarios") {
            scenarioList.data = getListOfSizingScenarios();
            webix.ui([sizingScenariosWindows], $$("theWholeThing"));
        }

    }


    function showClickMessage() {
        webix.message("I been clicked!");
    }

    function getWebixObject(name) {
        return $$(name);
    }

</script>

<script>


    scenarioList.data = getListOfSizingScenarios();


    var movementsWindow = {cols: [toolbar, fpListWithHeader, {view: "resizer"}, dataGridBody]};
    var dataGroupWindow = {cols: [toolbar, dataGroupListWithHeader, {view: "resizer"}, dataGroupBody]};

    var sizingScenariosWindows = {cols: [toolbar, scenarioListWithHeader, {view: "resizer"}, dataGridBody]};
    var systemContextsWindows = {cols: [toolbar, systemContextWithHeader, {view: "resizer"}, systemContextBody]};
    var openingScreen = {cols: [toolbar, openingScreenBody]};

    var theWholeScreen = ({
        container: "webixUItable",
        id: "theWholeThing",
        type: "wide"
    });

    theWholeScreen.rows = [openingScreen];
    webix.ui(theWholeScreen);


    webix.ui(editDataMovementForm);
    webix.ui(selectDataGroupForm);
    webix.ui(contextMenu);
    webix.ui(addFunctionalProcessWindow);
    webix.ui(addDataGroupWindow);
    webix.ui(editDataAttributesWindow);
    $$("ctxMenu").attachTo($$("fpGrid"));


</script>


</body>
</html>